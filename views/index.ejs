<%- include('partials/header') %>

<div class="d-flex justify-content-between align-items-center mb-3">
    <h2>Minhas Tarefas</h2>
    <a href="/tarefas/nova" class="btn btn-primary">Nova Tarefa</a>
</div>

<% 
const prioridadeClasses = {
    'baixa': 'border-secondary',
    'mÃ©dia': 'border-warning',
    'alta': 'border-danger'
};
%>

<div class="row">
    <% if (tarefas.length > 0) { %>
        <% tarefas.forEach(tarefa => { %>
            <div class="col-md-4 mb-3">
                <div class="card <%= prioridadeClasses[tarefa.prioridade] %> border-3">
                    <div class="card-body">
                        <h5 class="card-title"><%= tarefa.titulo %></h5>
                        <h6 class="card-subtitle mb-2 text-muted">
                            Vencimento: <%= new Date(tarefa.data_vencimento).toLocaleDateString('pt-BR') %>
                        </h6>
                        <p class="card-text"><%= tarefa.descricao %></p>
                        <span class="badge bg-info text-dark mb-2"><%= tarefa.status %></span>
                        <br>

                        <a href="/tarefas/editar/<%= tarefa._id %>" class="btn btn-sm btn-warning">Editar</a>

                        <form action="/tarefas/deletar/<%= tarefa._id %>" method="POST" class="d-inline" 
                              onsubmit="return confirm('Tem certeza que deseja excluir esta tarefa?');">
                            <button type="submit" class="btn btn-sm btn-danger">Excluir</button>
                        </form>
                    </div>
                </div>
            </div>
        <% }) %>
    <% } else { %>
        <p class="text-center">Nenhuma tarefa encontrada.</p>
    <% } %>
</div>

<%- include('partials/footer') %>